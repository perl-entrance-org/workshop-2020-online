# Perl 入学式 第 2 回

## 構文基礎編

---

## 諸注意

- 講義中の疑問点は Discord で質問して下さい。サポーターが適宜回答やアドバイスを行える様にスタンバイしています。

- うまくプログラムが動かない、分からない時は Discord #講義部屋 でサポーターにヘルプを要請してください。Discord のテキスト及び音声チャットにて個別にサポートします。

- <a href="https://discord.com/" target="_blank">Discord | 会話や交流が楽しめるプラットフォーム</a>

---

## 本日の内容

- 前回の復習
- コメント
- スカラー変数
- 四則演算
- 条件分岐（ if 文）
- 比較演算子（ <, >, ==, !=, eq, ne, gt, lt ）
- 論理演算子（ &&, || ）

---

# 前回の復習

---

## 前回の復習

### おまじない

```perl
#!/usr/bin/env perl
use strict;
use warnings;
```

以下、この資料のサンプルコードでは紙面の都合上｢おまじない｣を省略します。

皆さんは**必ず記述してください**。

---

## 前回の復習

### 練習問題 (nickname.pl)

"my nickname is ○○" と表示されるプログラムを作ってみましょう。

1. nickname.pl というファイルを作成してください。

2. nickname.pl に先程説明した "おまじない" を忘れないこと！

3. nickname 自己紹介文を画面に表示させるプログラムを 2 に続けて書きましょう。

ヒント 画面に文字（文）を表示させる命令は print です。

---

## （コラム）検索

最近は検索する(ググる)ことで解決することも多いです。

しかし、書籍を通読することで、体系だった知識を身につけることができます。

ネットの情報は玉石混交、一方で書籍の場合は情報の陳腐化があり、一長一短と言えます。

---

## （コラム）検索

最初は誰しも「記号」が分からないので、ググるにも手がかりが無い場合、ドキュメント(<ruby><a href="https://perldoc.perl.org/" target="_blank">perldoc</a><rt>パールドック</rt></ruby> / <a href="https://perldoc.jp/" target="_blank">perldoc.jp</a>)を活用しましょう。

---

## コメント

---

## コメント

```perl
print "Hello World!";   # -- ここがコメント部 --

# print "Hello! Perl Entrance!"; 行頭に # があるため、printは実行されない
```

- 各プログラム言語にはスクリプトやプログラムをわかりやすくするために、コメントを入れる仕組みがあります。

- Perl では、 `#` より右にある文字列は全てコメントとして扱われます。

- コメントは実行されません。

- この資料の中でも、 コメントを使ってコードに補足を行います。

---

# スカラー変数

---

## スカラー変数

### 変数とは?

- ｢**<ruby>変数<rt>へんすう</rt></ruby>**｣は、いわば｢データを格納できる箱｣です。

- Perl の変数には、｢スカラ変数｣、｢<ruby>配列<rt>はいれつ</rt></ruby>｣、｢<ruby>連想配列<rt>れんそうはいれつ</rt></ruby>(ハッシュ)｣という 3 つの種類があります。

---

## スカラー変数

### 変数とは?

3 種類の変数は、それぞれの変数の型を示す **シジル(sigil)** という記号で区別されます。

1. スカラ変数(`$`)：1 つの要素を格納する。

1. 配列(`@`)：複数の要素を「順番に」格納する。

1. ハッシュ(`%`)：複数の要素を「名前 => 値」の組み合わせで格納する。

配列とハッシュ（連想配列）は第 3 回で解説予定です。

---

## スカラー変数

### スカラー変数を利用する

```perl
my $foo;    # 変数を宣言する
$foo = 1;   # 右辺の 1 を左辺の $foo に入れる
print "$foo\n";
```

- 変数を初めて使うときは、先頭に `my` をつけます。

- 変数が利用できるようにすることを「**変数を宣言**する」といいます。

---

## スカラー変数

### スカラー変数を利用する

```perl
my $foo;    # 変数を宣言する
$foo = 1;   # 右辺の 1 を左辺の $foo に入れる
print "$foo\n";
```

- スカラ変数の先頭には、`$foo` のように `$` をつけます。 `$` は`スカラ(scalar)`の `S` 、と覚えるとよいでしょう。

- `=` という記号(代入演算子)を使うことで、「右辺の値」を「左辺のスカラー変数 `$foo` 」に入れる(代入する)ことができます。

---

## スカラー変数

### スカラー変数を利用する

```perl
my $foo;    # 変数を宣言する
$foo = 1;          # 右辺の 1 を左辺の $foo に入れる
print "$foo\n";    # 1

$foo = "Hello World";   # $foo は宣言済みなので my は不要
                        # 右辺の "Hello World" が 左辺の $foo に入る
print "$foo\n";         # Hello World
```

- 宣言した変数を 2 回目以降に使うときは、 `my` は不要です。`my` は変数を宣言する最初のみ必要です。

- 値が入っているスカラー変数に別の値を代入すると、中身が上書きされます

---

## スカラー変数

### 仮の変数名（メタ構文変数）

```perl
my $foo;
my $bar = 1;
$bar = "Hello World";
```

- プログラム言語の参考書には以下の単語が変数名として利用されることがあります。

  - foo, bar, baz

  - hoge, piyo, fuga

---

## スカラー変数

### 仮の変数名（メタ構文変数）

- これら「意味のない名前」をつけることで、「サンプル用」「例示用」の変数ということを明示するためです。

- `foo`, `bar`, `buz` このような単語を使った変数を「**メタ構文変数**」と呼称します。

- これらの変数名は現場のコードでは利用しないようにしましょう。

---

## スカラー変数

### クォーテーションによる表示の違い

```perl
my $foo = 1;

print "$foo\n"; # ダブルクォーテーションで囲うと「1」が表示される

print '$foo\n'; # シングルクォーテーションで囲うと「$foo\n」が表示される
```

- `print` を使うことで変数を表示することができます。

---

## スカラー変数

### クォーテーションによる表示の違い

- 変数の中身を表示する場合は、 `" "(ダブルクォーテーション)`の中に変数を書きましょう。

  - `" "` の中に変数を書くと、その変数の中身が表示されます。

  - `' '` の中では、変数の中身ではなく、書いてあるままに表示されます。

---

## スカラー変数

### エラーメッセージ

```perl
#!/usr/bin/env perl
use strict;
use warnings;

my $hoge = "Hello"  # "hello"の後にセミコロンがない
print "$hoge\n";
```

- よくありがちなエラーとして、行末の「セミコロン `;` を忘れる」というものがあります。
- 先程のシンタックスチェックや、お約束の 3 行を書いた場合は次のようなエラーがでます。

```perl
syntax error at foo.pl line 7, near "print"
Execution of foo.pl aborted due to compilation errors.
```

- この場合、7 行目の print の周辺でシンタックスエラーが発生しているという意味になります

---

## スカラー変数

### エラー文は怖くない

Perl に限らず、プログラムのエラーメッセージのほとんどは英語で表示されます。

最初は戸惑うかもしれませんが、エラーメッセージ中にある行番号を手がかりに**直前・直後の行**でおかしいところを探してみましょう。

また、エラーメッセージそのものを Google などで検索したり、翻訳することでエラー解決への手がかりを掴むこともできます。

エラーが出るのは悪いことではありません。直すべき場所を明示してくれるありがたい指針です。

**エラーを出さずにプログラムを習得することはできません。**

落ち着いて対処していきましょう。

---

## スカラー変数

### 練習問題 1 (scalar_practice1.pl)

- 1 から９までの好きな数字をスカラ変数に格納し、それらの値を表示するスクリプト`scalar_practice1.pl`を作成しよう！

  - `number` 好きな数字を格納する変数

- 「お約束」の 3 行を忘れずに！

---

## スカラー変数

### 練習問題 2 (scalar_practice2.pl)

- 好きなプログラミング言語の名前をスカラ変数に格納し、それらの値を表示するスクリプト`scalar_practice2.pl`を作成しよう！

  - `language` 好きなプログラミング言語名

---

## スカラー変数

### 練習問題 3 (scalar_practice3.pl)

- Perl 入学式の情報をスカラ変数に格納し、それらの値を表示するスクリプト`scalar_practice3.pl`を作成しよう！

  - `seminar_name` この勉強会の名前
  - `date` 今日の日付

---

## （コラム）Perl5 のバージョンの歴史

- Perl 4 以前は前史として、既に周囲に環境が存在しないと思って良いです。

- 1994 年、Perl5 (Perl 5.000) が登場しました。

- 2000 年、Perl 5.6 が登場。この頃からインターネットやウェブというものが徐々に一般に普及していきます。

- 2002 年、Perl 5.8 が登場。国際化対応や今につながる様々な機能が搭載されます。5.8 時代が長かったため、多くのサービスで長きにわたって使われました。

参考: <a href="https://speakerdeck.com/anatofuz/regasiperlbirudo-xian-dai-nisu-ruperl-1-2-dot-0toperl6" target="_blank">レガシー Perl ビルド ~現代に蘇る Perl[1..5].0 と Perl6~</a>

---

## （コラム）Perl5.8 以降のバージョンの歴史

- 2007 年 : Perl 5.10 が登場。 後方互換性を維持した構文拡張等。
  以降、1 年に 1 回のマイナーバージョンアップ

- 2018 年 : Perl 5.28 が登場。

- 2019 年 : Perl 5.30 が登場。

- 2020 年 : Perl 5.32 が登場。 現在の最新の安定版です。

---

# 四則演算と文字列連結

---

## 四則演算と文字列連結

### 基本的な演算子(足し算・引き算)

```perl
my $foo = 4;
my $bar = 2;
my $result;

# 足し算 +
$result = $foo + $bar;    # 足し算 して $result に代入する
print "$foo + $bar = ";   # 式の表示だけ。改行はしない。
print "$result\n";        # 上の式に続けて $result を表示する

# 引き算 -
$result = $foo - $bar;    # 足し算 して $result に代入する
print "$foo - $bar = ";   # 表示だけ。改行はしない。
print "$result\n";        # 上の式に続けて $result を表示する
```

- 算数と同じ + と - が利用できます。

---

## 四則演算と文字列連結

### 基本的な演算子(掛け算・割り算)

```perl
my $foo = 4;
my $bar = 2;
my $result;

# 掛け算 * （アスタリスク）
$result = $foo * $bar;    # 掛け算 して $result に代入する
print "$foo * $bar = ";   # 表示だけ。改行はしない。
print "$result\n";        # 上の式に続けて $result を表示する

# 割り算 / （スラッシュ）
$result = $foo / $bar;    # 足し算 して $result に代入する
print "$foo / $bar = ";   # 表示だけ。改行はしない。
print "$result\n";        # 上の式に続けて $result を表示する
```

---

## 四則演算と文字列連結

### 基本的な演算子(べき乗・剰余)

```perl
my $foo = 4;
my $bar = 2;
my $result;

# べき乗 **
$result = $foo**$bar;       # 4 の 2乗 を $result に代入する
print "$foo ** $bar = ";    # 式の表示だけ。改行はしない。
print "$result\n";          # 上の式に続けて $result を表示する

# 剰余 %
$result = $foo % $bar;     # 4 を 2 で割った余りを $result に代入する
print "$foo % $bar = ";    # 表示だけ。改行はしない。
print "$result\n";         # 上の式に続けて $result を表示する
```

---

## 四則演算と文字列連結

### 剰余の使い所

<ruby>**剰余**<rt>じょうよ</rt><ruby>は、初めて聞く言葉かもしれません。利用例を解説します。

```perl
print 100 % 7;    # 100 / 7 の余りである 2
```

例えば「今日の 100 日後の曜日」を求めるとき、100 日分カレンダーを辿るのは大変です。

1 週間は 7 日なので、7 日後は同じ曜日となります。14 日後も同じ曜日となります。21 日、28 日、35 日... 7 の倍数日後は同じ曜日になります。

これを利用し、100 日 を 7 日 で割ってみます。剰余は 2 となります。

明日の曜日と同じであれば剰余は 1、 明後日と同じ曜日であれば 2、 と簡単に計算が可能です。

---

## 四則演算と文字列連結

### 練習問題(keisan.pl)

以下の問題を順番に書いて表示してみよう。

1. 変数 $num1 に10, $num2 に 3 を代入し、それぞれを画面に表示させる。

2. 変数$num1 から 変数$num2 を引いた数を画面に表示させる。

3. 変数$num1 を 変数$num2 で割った時の余りを表示させる。

---

## 四則演算と文字列連結

### 代入演算子の性質

```perl
my $foo = 4;

$foo = $foo * 3;  # 右辺の計算結果( 4 * 3 )が、左辺の $foo に代入される

print "$foo\n";   # 12
```

- 代入演算子 `=` は、算数のイコールとは性質が異なります。

  - 算数　　　：左辺と右辺が等しいことを示す

  - プログラム：右辺の計算結果を左辺に代入する

- 上記の例では右辺の「 \$foo \* 3 」つまり 12 が `=` の左辺 `$foo` に代入されます。

---

## 四則演算と文字列連結

### 省略記法

代入演算子（ `=` ）を利用して、変数の中身を書き換える処理は多いため、専用の記法が用意されています。

```perl
my $fuga = 100;
my $hoge = 50;

$fuga += 1;         # $fuga = $fuga + 1;と同じ
print "$fuga\n";    # 101
$fuga -= 1;         # $fuga = $fuga - 1;と同じ
print "$fuga\n";    # 100

$fuga *= 2;         # $fuga = $fuga * 2;と同じ
print "$fuga\n";    # 200
$fuga /= $hoge;     # $fuga = $fuga / $hoge と同じ
print "$fuga\n";    # 4
```

---

## 四則演算と文字列連結

### インクリメント

1 ずつ加算することを「インクリメント」といいます。この処理も多用するので、専用の記法が用意されています。

```perl
my $foo = 4;

$foo = $foo + 1;# 代入演算子を利用
print "$foo\n"; # 5

$foo += 1;      # 省略記法
print "$foo\n"; # 6

++$foo;         # 前置インクリメント
print "$foo\n"; # 7

$foo++;         # 後置インクリメント
print "$foo\n"; # 8
```

前置と後置の違いは[こちら](https://tutorial.perlzemi.com/blog/20180224151948.html)を参照

---

## 四則演算と文字列連結

### 練習問題(keisan2.pl)

以下の問題を順番に書いて表示してみよう。

1. 変数 \$num1 に 8 を代入し画面に表示させる。

2. 省略記法を使って、変数\$num1 を 10 倍し、画面に表示させる

3. \$num1 を 3 回インクリメントし、画面に表示させる。（正しくプログラムが書けていれば、83 と表示するはずです。）

---

## 四則演算と文字列連結

### 演算の順番

```perl
my $foo = 2 + 4 * 3;
print "$foo\n";    # 14

my $bar = ( 2 + 4 ) * 3;
print "$bar\n";    # 18
```

- 演算の順序は、 `( )` を付けることで変更することができます。

- 通常の数学と同じく、Perl も「足し算･引き算」より「掛け算･割り算」の優先順位が高いです。

- 2 行目では `( )` を付けることで優先順位を変え、「足し算」を先に計算させています。

---

## 四則演算と文字列連結

### 文字列連結

```perl
my $foo = 'hoge';
my $bar = 123;

print "$foo$bar\n";         # hoge123

print $foo . $bar . "\n";   # hoge123

my $buz = $foo . $bar;
print $buz . "\n";          # hoge123
```

- `.` (ドット)で文字列や変数を連結することができます。

- 連結した文字列や変数を、別の変数に代入することも可能です。

---

## 四則演算と文字列連結

### 練習問題(strconcat.pl)

以下のコードをコピペして、正しく出力される様に変数を連結するコードを続けて書いてみましょう。

my $str1 = "名前は";
my $str2 = "猫である。";
my $str3 = "まだ無い。";
my $str4 = "吾輩は";

---

## 四則演算と文字列連結

### 数値演算と文字列連結は分ける

演算の優先順位と結合方向(演算の向き)は perldoc の[perlop](http://perldoc.jp/docs/perl/5.22.1/perlop.pod#Operator32Precedence32and32Associativity)の項に詳細が記載されています。

ただし、これを覚えるのも、他の人に読んでもらうのも大変な労力です。

`( )`で演算の順番を明確に示す、数値演算と文字列の連結は分けて書くなど、わかりやすい記述を心がけましょう。

---

## 四則演算と文字列連結

### 数値演算と文字列連結の混合

数値演算と文字列連結を混ぜた場合の「アンチパターン（良くない例）」を示します。

```perl
my $now                 = 2020;
my $start_perl_entrance = 2012;
print "Perl入学式は開講" . $now - $start_perl_entrance . "年です\n"; # エラーメッセージの後に -2012年です
```

「-2012 年です」と、おかしな結果になります。これは演算子の優先順位が `.` と `-` で同じであり, 左結合のため, 左から演算されるためです.

1. まず 「`Perl入学式は開講`」（文字） と 「`2020`」（数字） が文字連結されます。（結果：「今年は開講 2020」）

1. 次に、「`今年は開講2020`」（文字） から 「`2012`」（数字）を引き算しようとし、おかしな結果になります。

---

## 四則演算と文字列連結

### 数値演算と文字列連結は分ける

文字と数値計算を明確に分けてから、 計算してから連結するのが確実です.

```perl
my $now                 = 2020;
my $start_perl_entrance = 2012;
print "Perl入学式は開講" . ($now - $start_perl_entrance ). "年です\n"; # Perl入学式は開講8年です

my $period = $now - $start_perl_entrance;
print "Perl入学式は開講" . $period . "年です\n"; # Perl入学式は開講8年です
```

- 1 番目の print 文のように、`( )`で演算の順序を変更することで、正しい結果になります。

- 2 番目のように、計算結果を別の変数に入れてから連結するのも良いでしょう。

---

## 四則演算と文字列連結

### 練習問題(sansuu1.pl)

以下の問題を Perl の四則演算を使って、変数を使わずに解いて表示してください。

- １＋２＋３＋４＋５＋６＋７＋８＋９＋１０

- １００ ー　２００

- １０００円の品物を消費税８%で買った時の税込価格

- 半径５ m の円の面積（円周率は３．１４とする）

---

## 練習問題(sansuu2.pl)

以下の問題を Perl の四則演算を使って解いてください。

`my $pizza = 10` を使って解いて表示してください

- １０個のピザを５人で分けた時の、一人当たりの個数

- １０個のピザを３人で分けた時の、余りの数

---

# 標準入力

---

## 標準入力

### 入力とは？

- これまでは、あらかじめスクリプトに書かれた文字や数字を表示してきました。

- スクリプトの実行の都度、中身を変える方法として「入力」を用いる方法があります。

- プログラムやコンピュータに様々な数値や文字列を与えることを「入力」と言います。

  - キーボードからの入力、ファイルからの入力、音声入力、カメラ、画面へのタッチ・・・

- 様々な入力のうち、キーボードから入力されるテキストデータのことを<ruby>**標準入力**<rt>ひょうじゅんにゅうりょく</rt></ruby>(Standard Input)といいます。

- 入力の終わりは Enter キー 又は return キー　となります。

---

## 標準入力

### Perl で標準入力を受け取る

```perl
my $str = <STDIN>;  # 標準入力から文字列を受け取り、変数 $str に代入する
chomp $str;         # $strの中の末尾の改行を削除する
print $str;         # $strを表示する
```

- `Perl` では、この「標準入力」をスクリプトの中で `<STDIN>` と表現します。

- 1 行目では、 `<STDIN>` で端末から入力された文字列を受け取り、受け取った文字列を変数 `$str` に代入しています。

  - 文字列（Strings）を表す変数として `$str` がよく利用されます。

- 2 行目では `chomp` で行末の改行を削除しています。

  - `<STDIN>` は改行が含まれているため、必須の処理です。

---

## 標準入力

### Perl で標準入力を受け取る

```perl
print 'input Season > ';    # 入力を促すメッセージ

my $season = <STDIN>;   # 標準入力 <STDIN> で入力されたものを $season に入れる

chomp $season;   # $season に格納された入力から、末尾の改行を削除する

print "Alice loves $season\n";    # 変数を表示して改行する
```

- このコードを実行して、 `<STDIN>` がどのような働きをするか見てみましょう。

- このように、標準入力によってスクリプトの実行結果を変えることが可能です。

---

## 標準入力

### 練習問題 (hello_stdin.pl)

```bash
Your Name?> Taro
Hello Taro!
Your OS?> macOS
macOS is useful OS!
```

- "Your Name?> " と画面に表示して名前の入力を求め、入力された名前の左側に Hello、右側に "!" を付けて表示するスクリプト `hello_stdin.pl` を作成しよう。

- さらに続けて "Your OS?> " と画面に表示して使用中の OS の入力を求め、入力された OS 名の右側に "is useful OS!" を付けて表示させるようにもしてみましょう。

---

## 標準入力

### 練習問題 (calc.pl)

標準入力`<STDIN>`から 0 以外の整数を 2 つ読み込み、 それらを四則演算(`+`, `-`, `*`, `/`)した結果を上の例のように表示するスクリプト `calc.pl`を作成しよう。

最初に`1`、次に`2`を入れた場合、以下のように表示されるスクリプトです。

```plaintext
1 + 2 = 3
1 - 2 = -1
1 * 2 = 2
1 / 2 = 0.5
```

---

## 標準入力

### 練習問題 (fight.pl)

ロールプレイングゲームの戦闘場面風のスクリプト`fight.pl`を作成しよう。

以下のサンプルプログラムをコピーペーストし、不足する部分のプログラムを追加して完成させましょう。

"敵があらわれた"メッセージに続いて、プレーヤーの行動を標準入力`<STDIN>`から入力する部分を追加しよう。

入力された行動を、"あなたは ●● を選んだ！"と画面に表示させよう。

```perl
print "敵があらわれた！どうする？\n";
print "たたかう, まほう, どうぐ, にげる\n";
print ">>";

# ここにプログラムを追加しよう

```

---

## 標準入力

### 練習問題 (bot.pl)

メッセージアプリの bot（メッセージを送ると自動で応答するプログラム）風のスクリプト`bot.pl`を作成しよう。
bot からの問いかけに答えると疑似的な会話の様になる様にプログラムを完成させましょう。

以下のサンプルプログラムをコピーペーストし、不足する部分のプログラムを追加して完成させましょう。

問いかけられたメッセージに答えると、その答えを利用して返事を返すようにしよう。

```perl
#!/usr/bin/env perl
use strict;
use warnings;

# << >>で囲まれた部分は、キーボードから入力された値を出力できるようにしよう。

print "ニックネームを教えて!\n>>>";
# ここにプログラムを追加しよう
print " <<ニックネーム>> さん、こんにちは!調子はどう？\n>>>";
# ここにプログラムを追加しよう
print "調子は <<入力した返事>> なんだね！\n"
print "明日のスケジュールを教えて？\n>>>"
# ここにプログラムを追加しよう
print " <<明日の予定>> がんばってね！\nそれじゃあまたね、バイバイ！\n>"

```

---

## （コラム）Perl5 の安定板と開発版

- 5.(偶数) が安定版、 5.(奇数) が開発版です。

- 5.(奇数) の開発版をあえてインストールする必要はありません。5.(偶数) の安定版をインストールしましょう。

- 基本的に最新版の一つ手前の安定版までがサポート対象です。

---

## （コラム）Perl5 の安定板と開発版

- 過去のバージョンの Perl が生き残っている現場も多いですが、今なら Perl 5.10 以降だけを考えれば良いです。

- Perl 5.10 以降から 5.32 まで、Perl 初学者にとって大きな違いはあまりありません。

---

# if 文

---

## if 文

### 条件分岐

スクリプトは上から下へ順番に処理されていきます。

しかし、変数の状態に応じてスクリプトの動きを分岐させることができます。これを **条件分岐** といいます。

条件分岐には様々なパターンがありますが、それらを **真** と **偽** の 2 つの組み合わせで表現します。

真 または 偽 の判断に用いる式を **条件式** といいます。

---

## if 文

### 条件式

条件式、と言っても難しいことではありません。

- 信号が青なら、横断歩道を渡っても良い
- 信号が青でないなら、横断歩道を渡ることはできない

これも立派な条件分岐です。

この場合の条件式は「信号が青であるか、青でないかを判断する」ものです。

---

## if 文

### Perl における偽値

条件式の結果は 真 または 偽 となります。Perl では、次の 5 つの値が｢偽｣の値として扱われます。

1. 数値｢`0`｣
1. 文字列｢`'0'`｣
1. 文字列｢`''`｣（シングルクォーテーションの連続、間に何もない。空文字ともいう。）
1. 空のリスト｢`()`｣ Perl 入学式では扱わない
1. `undef`（まだ値を設定していないスカラー変数）Perl 入学式では扱わない

これ以外の値は、Perl では全て「真」として扱われます。例示などで真の値が必要なときは数字の **1** が利用されます。

---

## if 文

### Perl には true/false がない

他のプログラミング言語では、`true` や `false` という単語に 真 または 偽 の意味を持たせたキーワードとして扱われることがあります。

しかし、Perl は `true` や `false` などで真偽値を表すことはできません。

また特別な意味もありません。

あくまで、Perl では先に述べた 5 つの偽値のみが偽、それ以外はすべて真となります。

---

## if 文

### if 文の構文（擬似コード）

Perl の if 文はこのような構造です。

```perl
if ( 条件式 ) {
    条件式の結果が 真 の場合に実行されるコード;
}
else {
    条件式の結果が 偽 の場合に実行されるコード;
}
```

先の青信号の例で例えてみます。

```perl
if ( 信号が青だ ) {
    信号を渡る
}
else {
    信号を渡らない
}
```

---

## if 文

### if 文の構文

Perl のコードです。

```perl
if ( 1 ) {           # 条件式の結果が明示的な「真」の値である 1
    print "OK\n";    # 条件が｢真｣なので出力される
}
else{
    print "NG\n";    # 実行されない
}
```

```perl
if ( 0 ) {           # 条件式の結果が「偽」の値である 0
    print "OK\n";    # 実行されない
}
else{
    print "NG\n";    # 条件が｢偽｣なので出力される
}
```

---

## if 文

### 数値の比較演算子

if 文は条件式によって実行結果が変わります。この条件式の中で利用するのが **比較演算子** です。まずは数値の比較演算子から紹介します。

```perl
== # 右辺と左辺が等しいならば「真」
!= # 右辺と左辺が等しくないならば「真」

<  # 右辺より左辺が小さいならば「真」
>  # 右辺より左辺が大きいならば「真」

<= # 右辺が左辺以上ならば「真」
>= # 右辺が左辺以下ならば「真」
```

数値同士を比較するときは、このような記号を用いた比較演算子を使います。

---

## if 文

## 数値を使った条件分岐

```perl
my $foo = 1;
if ( $foo == 1 ) {
    print "OK\n"; # こちらが表示される
}
else {
    print "NG\n";
}
```

条件式は `( )` の中の `$foo == 1` です。

`==` は **右辺と左辺が数値として等しければ真** であることを意味します。

条件式内で `$foo` が `1` と等しい場合に「真」となり、`OK` という文字が表示されます。 `$foo` が `1` と等しくない場合は、「偽」となり `else` に処理が移って `NG` という文字が表示されます。

---

## if 文

### よくあるまちがい (1)

```perl
my $foo == 1; # NG

my $bar =  1; # OK
```

数値の比較に用いる `==` と、代入の `=` を間違えています。

この場合、実行すると以下のエラーが出ます。

```perl
Useless use of numeric eq (==) in void context
```

「おまじない」の 3 行を忘れた場合はエラーが出ずに危険です。

---

## if 文

### よくあるまちがい (2)

```perl
my $foo = 1;

if ($foo =  1) { print $foo } # NG

if ($foo == 1) { print $foo } # OK
```

条件式に注目してください。

代入の `=` と、数値の比較に用いる `==` を間違えています。

この場合、実行すると以下のエラーが出ます。

```perl
Found = in conditional, should be ==
```

「おまじない」の 3 行を忘れた場合はエラーが出ずに危険です。

---

## 練習問題(bigorsmall.pl)

```perl
#!/usr/bin/env perl
use strict;
use warnings;
my $mycard = 10;    # 1から13までの好きな数字を入力しておく
```

トランプの大小判定ゲームを作ってみよう。

1. 変数 \$mycard に 1 から 13 までの好きな数字（これがトランプの手札）を代入します。

2. \$mycard の数が 7 より大きければ `BIG` と表示します。

3. それ以外(7 以下)であれば、 `SMALL` と表示します。

---

## if 文

### 文字列の比較演算子

文字列を比較する場合は `eq` や `ne` といった単語を用いた比較演算子を使います。

```perl
eq  # equal
ne  # not equal

gt  # greater than
ge  # greater equal

lt  # less than
le  # less equal
```

「文字列の大小」とは、文字列の長さではありません。

辞書順に並べた時に前にくるものが小さく、後ろにくるものが大きいという意味です。

---

## if 文

### 文字列を使った条件分岐

条件式に注目してください。

```perl
my $foo = 'hello';

if ( $foo eq 'hello' ) {
    print "OK\n";   # こちらが表示される
}
else {
    print "NG\n";
}
```

文字列を比較しているので、 `==` ではなく `eq`を用いています

---

## 練習問題(question_word.pl)

```perl
#!/usr/bin/env perl
use strict;
use warnings;
my $answer = 'perl';    # 好きな文字を入力しておく
```

簡単な文字当てゲーム `question_word.pl`を作成しよう。

1. ターミナルから標準入力で文字列を一つ入力します。

1. その文字列が `$answer` と一致したら`OK`と表示します。

1. 外れたら `NG` と表示します。

---

## if 文

### 数値 と 文字列 の比較を混合させる<br>アンチパターン

```perl
print "eq で評価すると、";
if ( '51.0' eq 51 ) {
    print "文字列'51.0' と 数値 51 は等しい\n";
}
else {
    print "文字列'51.0' と 数値 51 は等しくない\n"; # こちらが表示される
}
```

`eq` は文字列を比較するときに使う比較演算子です。

このため、条件式の左辺・右辺は文字列として **異なる** と判断されます。

---

## if 文

### 数値 と 文字列 の比較を混合させる<br>アンチパターン

```perl
print "== で評価すると、";
if ( '51.0' == 51 ) {
    print "文字列'51.0' と 数値 51 は等しい\n"; # こちらが表示される
}
else {
    print "文字列'51.0' と 数値 51 は等しくない\n";
}
```

条件式の比較演算子を `eq` から `==` に変更すると、先ほどとは逆の結果となります。

`==` は数値を比較するときに使う比較演算子です。

このため、条件式の左辺・右辺は数値として **等しい** と判断されます。

---

## if 文

### 複数の条件分岐

`elsif`を使うことで、分岐条件を増やすことができます。

```perl
my $foo = 1;

if ( $foo == 1 ) {
    print '$foo is One' . "\n"; # これが表示される
}
elsif ( $foo == 2 ) {
    print '$foo is Two' . "\n";
}
elsif ( $foo == 3 ) {
    print '$foo is Three' . "\n";
}
else {
    print '$foo is not even One, even Two, even Three' . "\n";
}
```

`else if` ではなく、 **`elsif`** です。

---

## 練習問題(bigsmall.pl)

先に作ったトランプの大小判定ゲームを改良してみよう。

1. 変数 \$mycard に標準入力から 1 から 13 までの好きな数字を、ターミナルから直接入力できる様に改造しよう。

2. \$mycard の数が 7 より大きければ `BIG!` と表示します。

3. \$mycard の数が 7 と等しければ、 `Seven!` と表示します。

4. \$mycard の数が 7 未満であれば、 `SMALL!` と表示します。

---

## 練習問題(register.pl)

ドリンク販売マシーンをつくろう

1. 下のコードをコピペして、プログラムを追加して完成させよう。

2. 四則計算、変数、標準入力、if 文を駆使しましょう。

3. 追加するプログラムは、注文（何杯購入か）を聞く、店内利用かテイクアウトを聞く、消費税を計算する、合計金額を出力する部分です。

```perl
#!/usr/bin/env perl
use strict;
use warnings;

print "ドリンク1杯300円です。いくつ注文しますか？\n>>>";
# ここにプログラムを追加しよう
print "ドリンクは '店内' 'テイクアウト' どちらでしょうか？\n(店内 or テイクアウト を入力)>>>";
# ここにプログラムを追加しよう
# 店内利用は10%、テイクアウトは8%の消費税率で計算しましょう。

# <<税込み金額>>の部分に計算結果を出力できるようにしよう。
print "お会計額は <<税込み金額>> 円です。\n";

```

---

# 論理演算子

---

##論理演算子

### 論理演算子 AND, OR

`if文` の条件式で複雑な条件を扱いたいときは **論理演算子** を用いて複数の条件を連結します。

```perl
&& # かつ

|| # または
```

- `&&` 演算子は｢かつ・AND｣の意味を持つ。両辺の条件が 真 となるときのみ 真 となる。

- `||` 演算子は｢または・OR｣の意味を持つ。両辺のうち、片方が 真 ならば 真 となる。

---

## 論理演算子

### AND

条件式に注目してください。

```perl
my $foo = 10;

if ( $foo > 0 && $foo % 2 == 0 ) {  # $fooが 0 より大きい かつ 2 で割り切れる
    print "&& : OK\n";    # こちらが表示される
}
else{
    print "&& : NG\n"
}
```

1. `&&` の左辺にある`$foo` が 0 より大きいので、`$foo > 0` を満たす。
1. `&&` の右辺にある`$foo` を 2 で割った剰余は 0 なので、`$foo % 2 == 0` も満たす。
1. 「1. かつ 2. が 真」の条件を満たすので、条件式は 真 となり、`&&: OK` と表示される。

---

## 論理演算子

### OR

条件式に注目してください。

```perl
my $foo = 10;

if ( $foo > 0 || $foo % 2 == 1 ) {  # $fooが 0 より大きい または 2 で割り切れない
    print "|| : OK\n";     # こちらが表示される
}
else{
    print "&& : NG\n"
}
```

1. `$foo` が 0 より大きいので、 `$foo > 0` を満たす。
1. 「1. または 2. が 真」の条件のうち、「1. が 真 」を満たすので、条件式は 真 となり、`||: OK` と表示される。

---

## 練習問題(seven.pl)

トランプの札判定プログラムを改造してみよう。

以下のサンプルプログラムは条件式に != や == 演算子を利用しています。 != と == 演算子を使わない条件式に書き換えてみましょう。

書き換えができたら、 \$mycard 変数の値を色々変えて正しく動くか、テストしてみましょう。

```perl
#!/usr/bin/env perl
use strict;
use warnings;

# 1から13のトランプカード1枚の数字を変数に格納します。
my $mycard = 10;

# if文の()の中の条件式を != を使わずに書き換えてみよう。
if ($mycard != 7){
  print "カードの数字は 7 以外です。\n";
}

# if文の()の中の条件式を == を使わずに書き換えてみよう。
if ($mycard == 7){
  print "カードの数字は 7 です。\n";
}

```

---

## 練習問題(color_height.pl)

"事前に与えられた情報"を判定するプログラムを書こう。

事前に設定された情報として、$tshirt変数に着ているTシャツの色、$height 変数に身長の情報が格納されています。

if 文の<<条件式>>を書いて、print 文の通り正しく判定される様に条件式を書いてみよう。

```perl
#!/usr/bin/env perl
use strict;
use warnings;

# 赤いシャツを着た身長160cnの人
my $tshirt = "red";
my $height = 160;

if (<<条件式>>){
  print "赤いTシャツを着ている身長180cm未満の人です。\n";
}

if (<<条件式>>){
  print "青いTシャツを着ている、または身長180cm未満の人です。\n";
}

if (<<条件式>>){
  print "赤いTシャツ又は青いTシャツを着ている、身長180cm以上の人です。\n";
}
```

---

## 論理演算子

### 3 つ以上の値を比較したい場合

```perl
my $small  = 10;
my $medium = 20;
my $large  = 30;

if ( $small < $medium <= $large ) { # Perl 5.30までのバージョンではエラーになる
    print "小さい順に並んでます\n";
}
```

`$small < $medium < $large` のように、に 3 つ以上の値を同時に比較することはできません。

下記のようなエラーとなります。

    syntax error at sample.pl line 5, near "$medium <"

ただし、2020 年にリリースされた Perl 5.32 より、3 つ以上の値を同時に比較することが可能になりました。

---

## 論理演算子

### 3 つ以上の値を比較したい場合(Perl 5.32 以降)

```perl
my $small  = 10;
my $medium = 20;
my $large  = 30;

if ( $small < $medium <= $large ) { # 不等号が2種類ある
    print "小さい順に並んでます\n";
}
```

不等号をはじめ、演算子には[優先順位](https://perldoc.jp/docs/perl/perlop.pod)があります。

上記の例の場合、以下のように解釈されます。

```perl
$small < $medium  && $medium <= $large
```

---

## 論理演算子

### 3 つ以上の値を比較したい場合

```perl
my $small  = 10;
my $medium = 20;
my $large  = 30;

if ( $small < $medium && $medium <= $large ) {
    print "小さい順に並んでます\n";
}
```

`$small < $medium` かつ `$medium <= $large` というように、論理演算子を使って比較することも可能です。

---

## 練習問題(question_num.pl)

```perl
#!/usr/bin/env perl
use strict;
use warnings;
my $answer = 10;    # 好きな値を入力しておく
```

簡単な数当てゲーム `question_num.pl`を作成しよう。

ターミナルから数字を一つ入力し、その数字とスクリプト中の `$answer`　と比較して以下のように表示してください。

- `$answer` と一致したら `OK`

- `$answer` より大きければ `too big`

- `$answer` より小さければ `too small`

- （余裕があれば）入力した値が `$answer`から -5 〜 +5 の範囲内(例えば、`$answer`が 10 なら 5〜15)の場合、`near`と表示する。

---

## （コラム）TMTOWTDI

Perl のスローガン、「ティムトゥーディー」と読みます。

" There's more than one way to do it. " の頭文字をとったもの。

意味は「やり方はひとつじゃない」。

---

## （コラム）TMTOWTDI

Larry は「プログラミング言語は、いろんな対象をシンプルに記述する為に、ある程度複雑でなければならない」と信じています。

Perl は同じ処理を、様々な書き方で表すことができます。

これについては、きっとこれからの Perl 入学式のカリキュラムの中で実際に体験することになります。
